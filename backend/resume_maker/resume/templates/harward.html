<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>
    {{ (name | default('Your Name')) ~ ' — Resume' }}
  </title>

  <link rel="stylesheet" href="templates/assets/harward.css">

  <style>
    @page { size: A4; margin: 15mm; }
    html, body { height: 100%; }
  </style>
</head>
<body>

<main class="page container-fluid">

  <!-- Header -->
  <header class="resume-header">
    <div class="d-flex flex-column flex-lg-row justify-content-between align-items-lg-end gap-2">
      <div>
        <h1 class="m-0 fw-bold">{{ name | default('Your Name') }}</h1>
        {% set subtitle = title or (profile and profile.job_title) %}
        {% if subtitle %}
          <div class="subtitle text-muted">{{ subtitle }}</div>
        {% endif %}
      </div>

      {# Contacts from top-level 'contacts' #}
      {% if contacts and (contacts.email or contacts.phone or contacts.github or contacts.linkedin or contacts.location) %}
      <ul class="contact list-inline m-0 small text-muted">
        {% if contacts.email %}<li class="list-inline-item">{{ contacts.email }}</li>{% endif %}
        {% if contacts.phone %}<li class="list-inline-item">{{ contacts.phone }}</li>{% endif %}
        {% if contacts.github %}<li class="list-inline-item">{{ contacts.github }}</li>{% endif %}
        {% if contacts.linkedin %}<li class="list-inline-item">{{ contacts.linkedin }}</li>{% endif %}
        {% if contacts.location %}<li class="list-inline-item">{{ contacts.location }}</li>{% endif %}
      </ul>
      {% endif %}
    </div>
  </header>

  <!-- Profile (from top-level 'profile' dict) -->
  {% if profile and (profile.summary or profile.key_skills or profile.highest_degree) %}
  <section class="resume-section no-break">
    <h2 class="section-title">Profile</h2>
    {% if profile.summary %}
      <p class="mb-2">{{ profile.summary }}</p>
    {% endif %}

    {% if profile.key_skills %}
      <div class="fw-semibold">Key Skills</div>
      <ul class="pill-list">
        {% for s in profile.key_skills %}
          <li class="pill">{{ s }}</li>
        {% endfor %}
      </ul>
    {% endif %}

    {% if profile.highest_degree %}
      <div class="muted-line mt-2">{{ profile.highest_degree }}</div>
    {% endif %}
  </section>
  {% endif %}

  <!-- Education (top-level 'education' list) -->
  {% if education and education|length > 0 %}
  <section class="resume-section no-break">
    <h2 class="section-title">Education</h2>
    {% for ed in education %}
      {% if ed.education or ed.date or ed.description %}
      <div class="item">
        <div class="item-header">
          <div class="item-left fw-semibold">
            {{ ed.education }}
          </div>
          {% if ed.date %}
            <div class="item-right text-muted">{{ ed.date }}</div>
          {% endif %}
        </div>
        {% if ed.description %}
        <ul class="bullets">
          <li>{{ ed.description }}</li>
        </ul>
        {% endif %}
      </div>
      {% endif %}
    {% endfor %}
  </section>
  {% endif %}

  <!-- Experience (top-level 'experience' list) -->
  {% if experience and experience|length > 0 %}
  {% set nonempty_ex = experience | selectattr('position_or_company') | list %}
  {% set has_any = (nonempty_ex|length > 0) or (experience | selectattr('description') | list | length > 0) or (experience | selectattr('date') | list | length > 0) %}
  {% if has_any %}
  <section class="resume-section no-break">
    <h2 class="section-title">Experience</h2>
    {% for ex in experience %}
      {% if ex.position_or_company or ex.date or ex.description %}
      <div class="item">
        <div class="item-header">
          <div class="item-left fw-semibold">
            {{ ex.position_or_company }}
          </div>
          {% if ex.date %}
            <div class="item-right text-muted">{{ ex.date }}</div>
          {% endif %}
        </div>
        {% if ex.description %}
        <ul class="bullets">
          <li>{{ ex.description }}</li>
        </ul>
        {% endif %}
      </div>
      {% endif %}
    {% endfor %}
  </section>
  {% endif %}
  {% endif %}

  <!-- Skills (skills.sections[] with label/items/note) -->
  {% if skills and skills.sections %}
  <section class="resume-section no-break">
    <h2 class="section-title">Skills</h2>
    {% for sec in skills.sections %}
      {% if sec.label %}<div class="fw-semibold">{{ sec.label }}</div>{% endif %}
      {% set items = sec.get('items', []) %}
      {% if items %}
      <ul class="pill-list">
        {% for it in items %}
          <li class="pill">{{ it }}</li>
        {% endfor %}
      </ul>
      {% endif %}
      {% if sec.note %}<div class="muted-line mt-1">{{ sec.note }}</div>{% endif %}
      {% if not loop.last %}<div class="mb-1"></div>{% endif %}
    {% endfor %}
  </section>
  {% endif %}

  <!-- References (top-level 'references' list) -->
  {% if references and references|length > 0 %}
  <section class="resume-section no-break">
    <h2 class="section-title">References</h2>
    <ul class="bullets">
      {% for ref in references %}
        <li>
          {% if ref.name %}<strong>{{ ref.name }}</strong>{% endif %}
          {% if ref.relationship_or_title %} — {{ ref.relationship_or_title }}{% endif %}
          {% if ref.contact %} — <a href="mailto:{{ ref.contact }}">{{ ref.contact }}</a>{% endif %}
        </li>
      {% endfor %}
    </ul>
  </section>
  {% endif %}

</main>

</body>
</html>
